# LAPISAN 2: DENY DIRECTORY BROWSING
# Mencegah orang lain melihat daftar file di dalam folder ini.
Options -Indexes

# LAPISAN 3: BLOCK DANGEROUS HTTP METHODS
# Memblokir metode HTTP yang tidak diperlukan dan bisa dieksploitasi.
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_METHOD} !^(GET|POST) [NC]
    RewriteRule ^(.*)$ - [F,L]
</IfModule>

# LAPISAN 4: PREVENT COMMON ATTACKS
# Memblokir permintaan yang mengandung karakter atau string berbahaya.
RewriteCond %{QUERY_STRING} [a-zA-Z0-9_]=http:// [OR]
RewriteCond %{QUERY_STRING} [a-zA-Z0-9_]=(\.\.//?)+ [OR]
RewriteCond %{QUERY_STRING} (localhost|127\.0\.0\.1) [OR]
RewriteCond %{QUERY_STRING} (<|%3C).*script.*(>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} (\\|\'|\"|\`) [NC,OR]
RewriteCond %{QUERY_STRING} union.*select.*from [NC,OR]
RewriteCond %{QUERY_STRING} concat\( [NC]
RewriteRule ^(.*)$ - [F,L]

# LAPISAN 5: USERNAME & PASSWORD PROTECTION (OPTIONAL)
# Ini menambahkan lapisan keamanan ganda di atas login.php.
# Hapus bagian ini jika Anda tidak ingin menggunakan autentikasi HTTP.
# AuthType Basic
# AuthName "Restricted Area"
# AuthUserFile /home/user/.htpasswds/.htpasswd
# Require valid-user