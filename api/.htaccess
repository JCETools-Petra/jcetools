# ----------------------------------------------------------------------
# JCE TOOLS API SECURITY CONFIGURATION
# ----------------------------------------------------------------------

# 1. Matikan Directory Listing
# Hacker tidak akan bisa melihat daftar file jika membuka folder /api/ di browser
Options -Indexes

# 2. Aktifkan Rewrite Engine
<IfModule mod_rewrite.c>
    RewriteEngine On

    # ------------------------------------------------------------------
    # BLOKIR AKSES FOLDER INTERNAL
    # ------------------------------------------------------------------
    # Mencegah akses langsung ke folder 'utils', 'vendor', atau folder '.' (hidden)
    # File PHP Anda tetap bisa melakukan 'require' atau 'include', 
    # tapi hacker tidak bisa membukanya via URL.
    RewriteRule ^(utils|vendor|\.git)/ - [F,L]

    # ------------------------------------------------------------------
    # BLOKIR FILE SENSITIF BERDASARKAN EKSTENSI
    # ------------------------------------------------------------------
    # Mencegah akses ke file .env, .log, .json, .lock, dll.
    RewriteRule \.(env|log|ini|lock|git|yml|yaml|sql|sh|bat)$ - [F,L]
    RewriteRule (composer\.json|package\.json|LICENSE|README\.md)$ - [F,L]
</IfModule>

# 3. Perlindungan Tambahan (FilesMatch)
# Ini adalah lapisan keamanan kedua jika mod_rewrite gagal/mati
<FilesMatch "(\.(env|log|ini|git)|^\.)">
    Order allow,deny
    Deny from all
</FilesMatch>

# 4. Blokir akses ke file konfigurasi PHP tertentu jika ada di root api
<FilesMatch "^(config|database)\.php$">
    Order allow,deny
    Deny from all
</FilesMatch>

# ----------------------------------------------------------------------
# OPTIONAL: FORCE HTTPS (Disarankan diaktifkan)
# ----------------------------------------------------------------------
<IfModule mod_rewrite.c>
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>