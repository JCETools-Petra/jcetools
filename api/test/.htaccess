# JCE Tools API - Security Configuration

# Disable directory listing
Options -Indexes

# Protect sensitive files
<FilesMatch "\.(log|sql|ini|conf|bak|backup)$">
    Require all denied
</FilesMatch>

# Security Headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "DENY"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "no-referrer"
    Header always set Content-Security-Policy "default-src 'none'; script-src 'none'; object-src 'none'"

    # Remove server signature
    Header unset Server
    Header unset X-Powered-By
</IfModule>

# Force HTTPS (uncomment when SSL is configured)
# <IfModule mod_rewrite.c>
#     RewriteEngine On
#     RewriteCond %{HTTPS} off
#     RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]
# </IfModule>

# Rate limiting (if mod_ratelimit available)
<IfModule mod_ratelimit.c>
    SetOutputFilter RATE_LIMIT
    SetEnv rate-limit 400
</IfModule>

# PHP settings
<IfModule mod_php.c>
    php_flag display_errors Off
    php_flag log_errors On
    php_value error_log /var/log/jcetools/php_errors.log
</IfModule>
